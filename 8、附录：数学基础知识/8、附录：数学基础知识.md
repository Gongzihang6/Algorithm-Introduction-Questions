# 第八部分 附录：数学基础知识

## 附录A 求和

### 练习A.1

A. 1-1 求 $$\sum_{k=1}^n (2k - 1)$$ 的简化形式。

*A. 1-2 利用调和级数证明：$$\sum_{k=1}^n \frac{1}{2k - 1} = \ln(\sqrt{n}) + O(1)$$。

A. 1-3 证明：$$\sum_{k=0}^{\infty} k^2 x^k = \frac{x(1 + x)}{(1 - x)^3}$$ 在 $$|x| < 1$$ 条件下成立。

*A. 1-4 证明 $$\sum_{k=0}^{\infty} \frac{k - 1}{2^k} = 0$$。

*A. 1-5 对于 $$|x| < 1$$，计算 $$\sum_{k=1}^{\infty} (2k + 1)x^{2k}$$ 的值。

A. 1-6 用和的线性性质证明：$$\sum_{k=1}^n O(f_k(i)) = O\left(\sum_{k=1}^n f_k(i)\right)$$。

A. 1-7 计算乘积 $$\prod_{k=1}^n 2 \cdot 4^k$$。

*A. 1-8 计算乘积 $$\prod_{k=2}^n \left(1 - \frac{1}{k^2}\right)$$。

### 练习A.2

A. 2-1 证明：$$\sum_{k=1}^n \frac{1}{k^2}$$ 有常数上界。

A. 2-2 求下面和式的一个渐近上界：
$$
\sum_{k=0}^{\lfloor \lg n \rfloor} \left\lceil \frac{n}{2^k} \right\rceil
$$

A. 2-3 通过分割求和的方式证明第 $$n$$ 个调和数是 $$\Omega(\lg n)$$。

A. 2-4 用积分方法求 $$\sum_{k=1}^n k^3$$ 的近似值。

A. 2-5 为什么我们不在 $$\sum_{k=1}^n \frac{1}{k}$$ 上使用积分近似(公式 A. 12)来获得第 $$n$$ 个调和数的上界？

### 思考题

A-1（确定和的界）请给出下面和式的渐近紧确界。假设 $$r \geqslant 0$$ 与 $$s \geqslant 0$$ 均为常数。

a. $$\sum_{k=1}^n k^r$$

b. $$\sum_{k=1}^n \lg^s k$$

c. $$\sum_{k=1}^n k^r \lg^s k$$

## 附录B 集合等离散数学内容

### 练习B.1

B. 1-1 用维恩图来描述分配律中第一条定律(B.1)。

B. 1-2 证明推广到任意有限数目集合的广义德·摩根定律：
$$
\begin{align*}
&\overline{A_1 \cap A_2 \cap \cdots \cap A_n} = \overline{A_1} \cup \overline{A_2} \cup \cdots \cup \overline{A_n} \\
&\overline{A_1 \cup A_2 \cup \cdots \cup A_n} = \overline{A_1} \cap \overline{A_2} \cap \cdots \cap \overline{A_n}
\end{align*}
$$

*B. 1-3 证明等式(B.3)的推广，即容斥原理：
$$
\begin{align*}
\left|A_1 \cup A_2 \cup \cdots \cup A_n\right| = &\left|A_1\right| + \left|A_2\right| + \cdots + \left|A_n\right| \\
&- \left|A_1 \cap A_2\right| - \left|A_1 \cap A_3\right| - \cdots \\
&+ \left|A_1 \cap A_2 \cap A_3\right| + \cdots \\
&+ (-1)^{n-1} \left|A_1 \cap A_2 \cap \cdots \cap A_n\right|
\end{align*}
$$

B. 1-4 证明：奇自然数集合是可数的。

B. 1-5 证明：对于任意有限集 $$S$$，其幂集 $$2^S$$ 有 $$2^{|S|}$$ 个元素(即 $$S$$ 存在 $$2^{|S|}$$ 个不同的子集)。

B. 1-6 请通过扩展有序对的集合论定义来给出 $$n$$ 元组的一个归纳定义。

### 练习B.2

B. 2-1 证明：集合 $$\mathbb{Z}$$ 的所有子集上的子集关系“$$\subseteq$$”是偏序关系，但不是全序关系。

B. 2-2 证明：对于任意正整数 $$n$$，关系“模 $$n$$ 等价”是整数集上的等价关系。（如果存在一个整数 $$q$$，使得 $$a - b = qn$$，则有 $$a \equiv b (\text{mod } n)$$。）这个关系将整数划分为哪些等价类？

B. 2-3 给出符合如下条件的关系的例子：
		a. 具有自反性和对称性，但不具有传递性。
		b. 具有自反性和传递性，但不具有对称性。
		c. 具有对称性和传递性，但不具有自反性。

B. 2-4 设 $$S$$ 是一个有限集，$$R$$ 是 $$S \times S$$ 上的一个等价关系。证明：如果 $$R$$ 同时有反对称性，则 $$S$$ 关于 $$R$$ 划分出的等价类是单元集。

B. 2-5 Narcissus 教授声称：如果关系 $$R$$ 具有对称性和传递性，则其也具有自反性。他给出了如下证明：由对称性，$$aRb$$ 蕴涵 $$bRa$$，因此，由传递性可得 $$aRa$$，自反性得证。请问 Narcissus 教授的证明正确吗？

### 练习B.3

B. 3-1 令 $$A$$ 和 $$B$$ 是有限集合，$$f: A \rightarrow B$$ 是一个函数，证明：
a. 若 $$f$$ 是单射，则 $$|A| \leqslant |B|$$；
b. 若 $$f$$ 是满射，则 $$|A| \geqslant |B|$$。

B. 3-2 请问函数 $$f(x) = x + 1$$ 是从 $$\mathbb{N}$$ 到 $$\mathbb{N}$$ 的双射吗？它是从 $$\mathbb{Z}$$ 到 $$\mathbb{Z}$$ 的双射吗？

B. 3-3 请给出二元关系的逆的一个自然的定义，满足如果一个关系实际上是双射函数，那么其关系逆即是其函数逆。

*B. 3-4 请举一个从 $$\mathbb{Z}$$ 到 $$\mathbb{Z} \times \mathbb{Z}$$ 的双射例子。

### 练习B.4

B. 4-1 在一个教职员工聚会中，与会者互相握手问候彼此，每位教授会记住他/她握手的次数。在聚会的最后，系主任将所有教授握手的次数相加。通过证明下面的握手定理来说明系主任得到的结果是偶数：如果 $$G=(V, E)$$ 是无向图，则有
$$
\sum_{v \in V} \operatorname{degree}(v) = 2|E|
$$

B. 4-2 证明：如果无向图或有向图在两个顶点 $$u$$ 和 $$v$$ 之间包含一条路径，则该图一定包含一条 $$u$$ 与 $$v$$ 之间的简单路径。证明：如果一个有向图包含环，则它一定包含一个简单环。

B. 4-3 证明：任意连通无向图 $$G=(V, E)$$ 满足 $$|E| \geqslant |V| - 1$$。

B. 4-4 验证在一个无向图中，“从……可达”关系是图中顶点的等价关系。等价关系的三个特性中，哪些对有向图点集上的“从……可达”关系成立？

B. 4-5 图 B-2(a) 中有向图的无向版本是什么？图 B-2(b) 中无向图的有向版本是什么？

*B. 4-6 证明：若令超图中的边与点的关联关系对应二分图中的邻接关系，则超图可表示为二分图。（提示：令二分图中的一个顶点集对应超图的顶点集，并令二分图的另一个顶点集合对应超边集。）

### 练习B.5

B. 5-1 画出包含三个顶点 $$x, y$$ 和 $$z$$ 的所有自由树。画出所有包含结点 $$x, y$$ 和 $$z$$ 的以 $$x$$ 为根的有根树。画出所有包含结点 $$x, y$$ 和 $$z$$ 的以 $$x$$ 为根的有序树。画出所有结点为 $$x, y$$ 和 $$z$$ 的以 $$x$$ 为根的二叉树。

B. 5-2 令 $$G=(V, E)$$ 为一个有向无环图，其中存在一个顶点 $$v_0 \in V$$，满足从 $$v_0$$ 到其他每个顶点 $$v \in V$$ 均有唯一路径。证明：$$G$$ 的无向版本是一棵树。

B. 5-3 利用归纳法证明：任何非空二叉树中 2 度结点数比叶结点数少 1。证明：满二叉树中的内部结点数目比叶结点数目少 1。

B. 5-4 利用归纳法证明，一个有 $$n$$ 个结点的非空二叉树的高度至少为 $$\lfloor \lg n \rfloor$$。

*B. 5-5 一棵满二叉树的内路径长度是指所有内部结点深度之和。类似地，外路径长度是指所有叶结点深度之和。考虑一个有 $$n$$ 个内部结点的满二叉树，其内路径长度为 $$i$$，外路径长度为 $$e$$。证明 $$e = i + 2n$$。

*B. 5-6 我们将二叉树 $$T$$ 中的每个深度为 $$d$$ 的叶结点赋予权值 $$w(x) = 2^{-d}$$，并令 $$L$$ 为 $$T$$ 的叶结点集合。证明 $$\sum_{x \in L} w(x) \leqslant 1$$。（该不等式称为 Kraft 不等式。）

*B. 5-7 证明：若 $$L \geqslant 2$$，则每个叶结点数为 $$L$$ 的二叉树包含一棵子树，该子树有 $$L/3$$ 到 $$2L/3$$ 个叶结点。

### 思考题

B-1（图着色问题）给定一个无向图 $$G=(V, E)$$，$$G$$ 的 $$k$$ 着色是一个函数 $$c: V \rightarrow \{0, 1, \cdots, k-1\}$$，满足对于每条边 $$(u, v) \in E$$，有 $$c(u) \neq c(v)$$。换句话说，数字 0, 1, …, $$k-1$$ 代表了 $$k$$ 种颜色，邻接的顶点不能具有相同颜色。

a. 证明：任意树都可以是 2 可着色的。

b. 证明下列三条描述是等价的：
1. $$G$$ 是二分图。
2. $$G$$ 是 2 可着色的。
3. $$G$$ 没有奇数长度的环。

c. 令 $$d$$ 为图 $$G$$ 中任意顶点的最大度数。证明：$$G$$ 可以用 $$d+1$$ 种颜色着色。

d. 证明：如果 $$G$$ 有 $$O(|V|)$$ 条边，那么 $$G$$ 可以用 $$O(\sqrt{|V|})$$ 种颜色着色。

B-2（友谊图）将下列描述改写成关于无向图的定理，并给出证明。假定友谊是对称的，但不是自反的。

a. 任何至少含两人的组中，至少有两人在组内有相同数目的朋友。

b. 任何 6 人的组要么至少有三个人互为朋友，要么至少有三个人互不相识。

c. 每个组中的人均能分成两个子组，其中每个属于某个子组的至少有一半的朋友在另外一个子组。

d. 如果一个组中每个人都至少是该组内一半人的朋友，那么该组可以按如下方式安排组员坐在圆桌周围：每个人都坐在他的两个朋友之间。

B-3（二等分树）许多图的分治算法要求图被等分为两个大小基本相同的子图。这可以通过在划分顶点后，求取两个点集的导出子图来实现。本题将研究通过移除一小部分边来将树二等分的方法。要求如果在移除边后两个顶点落在了同一棵子树中，则它们一定在同一个划分内。

a. 证明：任意 $$n$$ 顶点二叉树的顶点均可通过移除一条边被划分为两个集合 $$A$$ 与 $$B$$，满足 $$|A| \leqslant 3n/4, |B| \leqslant 3n/4$$。

b. 通过给出一个例子：一棵简单二叉树在移除一条边后，其最均匀平衡的划分满足 $$|A| = 3n/4$$，来证明 (a) 中的常数 3/4 在最坏情况下是最优的。

c. 证明：通过移除最多 $$O(\lg n)$$ 条边，可以将任意 $$n$$ 顶点二叉树的顶点划分为两个集合 $$A$$ 与 $$B$$，满足 $$|A| = \lfloor n/2 \rfloor$$ 和 $$|B| = \lceil n/2 \rceil$$。

## 附录C 计数与概率

### 练习C.1

C. 1-1 请问一个 $$n$$ 串中有多少个 $$k$$ 子串？（将不同位置上同样的 $$k$$ 子串看做不同子串。）一个 $$n$$ 串总共有多少个子串？

C. 1-2 有 $$n$$ 个输入、$$m$$ 个输出的布尔函数是从 $$\{TRUE, FALSE\}^*$$ 到 $$\{TRUE, FALSE\}^m$$ 的一个函数。请问有多少个有 $$n$$ 个输入、1 个输出的布尔函数？有多少个有 $$n$$ 个输入、$$m$$ 个输出的布尔函数？

C. 1-3 请问让 $$n$$ 个教授围坐在圆形会议桌的方法有多少种？如果两种座次中，一种可以通过旋转变成另一种，则视这两种座次相同。

C. 1-4 请问从集合 $$\{1, 2, \cdots, 99\}$$ 中选出三个不同的数字，并且这三个数字的和为偶数的方法有多少种？

C. 1-5 证明如下恒等式在 $$0 < k \leqslant n$$ 时成立：
$$
\binom{n}{k} = \frac{n}{k} \binom{n-1}{k-1} \quad \text{(C. 8)}
$$

C. 1-6 证明如下恒等式在 $$0 \leqslant k < n$$ 时成立：
$$
\binom{n}{k} = \frac{n}{n-k} \binom{n-1}{k}
$$

C. 1-7 为了从 $$n$$ 个对象中选择 $$k$$ 个，可以从这些元素中选出一个作为特殊元素，并且考虑是否选中该特殊元素。请使用这一方法证明
$$
\binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}
$$

C. 1-8 使用练习 C. 1-7 的结论，为二项式系数 $$\binom{n}{k}$$ 制作一个表格，其中 $$n=0,1,\cdots, 6, 0 \leqslant k \leqslant n$$。表格中 $$\binom{0}{0}$$ 在最顶行，$$\binom{1}{0}$$ 和 $$\binom{1}{1}$$ 在下一行，依此类推。这样的一个二项式系数表格称为帕斯卡三角。

C. 1-9 证明：
$$
\sum_{i=1}^n i = \binom{n+1}{2}
$$

C. 1-10 证明：对于任意整数 $$n \geqslant 0$$ 和 $$0 \leqslant k \leqslant n, \binom{n}{k}$$ 在 $$k = \lfloor n/2 \rfloor$$ 或者 $$k = \lceil n/2 \rceil$$ 处取得最大值。

*C. 1-11 证明：对于任意整数 $$n \geqslant 0, j \geqslant 0, k \geqslant 0$$，且 $$j+k \leqslant n$$，有
$$
\binom{n}{j+k} \leqslant \binom{n}{j} \binom{n-j}{k} \qquad \text{(C. 9)}
$$
请给出公式的代数证明和基于从 $$n$$ 个物品中选 $$j+k$$ 个的方法的论证。并请给出相等关系不成立的一个例子。

*C. 1-12 对满足 $$0 \leqslant k \leqslant n/2$$ 的所有整数 $$k$$ 使用归纳法证明不等式 (C. 6)，并用等式 (C. 3) 将公式 (C. 6) 推广到满足 $$0 \leqslant k \leqslant n$$ 的所有整数 $$k$$ 上。

*C. 1-13 利用斯特林近似证明：
$$
\binom{2n}{n} = \frac{2^{2n}}{\sqrt{\pi n}} (1 + O(1/n)) \qquad \text{(C. 10)}
$$

*C. 1-14 通过将熵函数 $$H(\lambda)$$ 进行微分，证明其在 $$\lambda = 1/2$$ 时取得最大值。请问 $$H(1/2)$$ 是多少？

*C. 1-15 证明：对于任意整数 $$n \geqslant 0$$，有
$$
\sum_{k=0}^n \binom{n}{k} k = n 2^{n-1} \quad \text{(C. 11)}
$$

### 练习C.2

C. 2-1 Rosencrantz 教授抛掷一枚均匀硬币一次。Guildenstern 教授抛掷一枚均匀硬币两次。  
Rosencrantz 教授得到的正面朝上结果数多于 Guildenstern 教授的概率是多少？

C. 2-2 证明布尔不等式：对于有限或可数无限事件序列 $$A_1, A_2, \cdots$$，
$$
\operatorname{Pr}\left\{A_1 \cup A_2 \cup \cdots\right\} \leqslant \operatorname{Pr}\left\{A_1\right\} + \operatorname{Pr}\left\{A_2\right\} + \cdots \quad \text{(C.19)}
$$

C. 2-3 假设有 10 张牌，每张牌上分别标有从 1 到 10 的数字，且每张牌上的数字均不同，将牌充分混合。然后从牌堆中一次一张地移除三张牌。那么我们选出的三张牌按照 (递增) 顺序排列的概率是多少？

C. 2-4 证明：
$$
\operatorname{Pr}\{A \mid B\} + \operatorname{Pr}\{\bar{A} \mid B\} = 1
$$

C. 2-5 证明：对于任意事件集 $$A_1, A_2, \cdots, A_n$$，
$$
\begin{align*}
&\operatorname{Pr}\left\{A_1 \cap A_2 \cap \cdots \cap A_n\right\} = \operatorname{Pr}\left\{A_1\right\} \cdot \operatorname{Pr}\left\{A_2 \mid A_1\right\} \cdot \operatorname{Pr}\left\{A_3 \mid A_1 \cap A_2\right\} \cdots \\
&\operatorname{Pr}\left\{A_n \mid A_1 \cap A_2 \cap \cdots \cap A_{n-1}\right\}
\end{align*}
$$

*C. 2-6 描述一个以整数 $$a$$ 和 $$b$$ 为输入的过程，其中 $$0 < a < b$$。在这个过程中，抛掷均匀硬币，结果为正面朝上的概率为 $$a/b$$，反面朝上的概率为 $$(b-a)/b$$。请给出抛掷硬币次数期望的界，应为 $$O(1)$$。（提示：将 $$a/b$$ 表示为二进制。）

*C. 2-7 请给出构造满足下列条件的集合的方法：集合中元素为两两独立的 $$n$$ 个事件，但不存在包含 $$k > 2$$ 个相互独立元素的事件子集。

*C. 2-8 已知事件 $$C$$ 发生，如果
$$
\operatorname{Pr}\{A \cap B \mid C\} = \operatorname{Pr}\{A \mid C\} \cdot \operatorname{Pr}\{B \mid C\}
$$
则称两个事件 $$A$$ 和 $$B$$ 是条件独立的。请给一个简单而非平凡的例子，其中两个事件不独立，但是在已知第三个事件发生时条件独立。

*C. 2-9 你参加一个游戏。该游戏将奖品藏在了三个幕布之后。如果你选对了幕布，则可以赢得奖品。在你选择了一个幕布后，但是幕布还未揭开之前，主持人会揭开另两个幕布中一个空幕布（主持人知道哪个幕布后是空的），之后会询问你要不要改变你的选择。请问如果你改变了选择，那么你赢得奖品的几率将如何改变？（这一问题是著名的 Monty hall 问题，是以一个主持人经常让参赛者陷入这种困境的节目命名的。）

*C. 2-10 一个监狱看守从三个罪犯中随机挑选一个释放，并处死另两人。这个看守知道每个人会被释放还是处死，但是被禁止透漏给囚犯其自身的处置信息。称罪犯为 $$X$$、$$Y$$ 和 $$Z$$。罪犯 $$X$$ 以他已经知道了 $$Y$$ 和 $$Z$$ 中至少有一人会死为理由，私下问警卫两人中哪个会被处死。警卫不能透露给 $$X$$ 关于他自身的信息，但他告诉了 $$X$$，$$Y$$ 将被处死。$$X$$ 感到很开心，因为他认为他或者 $$Z$$ 将被释放，这意味着他被释放的概率现在是 $$1/2$$ 了。请问他的想法正确吗，或者他被释放的概率仍为 $$1/3$$？请解释。

### 练习C.3

C. 3-1 我们投掷两个普通的 6 面体骰子。两个骰子值之和的期望是多少？两个骰子值中的最大值的期望是多少？

C. 3-2 数组 $$A[1.. n]$$ 包含 $$n$$ 个不同数字，且顺序随机，每种排列均为等可能的。该数组中最大元素下标的期望是多少？最小元素下标值期望是多少？

C. 3-3 在一场狂欢节游戏中，将 3 个骰子放在一个罩子中。一位游戏者可以在 1 到 6 中的任意数字上赌 1 美元。主持人摇罩子，并按如下方案确定游戏者所得回报。如果游戏者赌的数字没有出现在任何一个骰子上，则他输掉 1 美元。如果他赌的数字恰好出现在 $$k$$ 个骰子上，$$k=1,2,3$$，则他可以保留他的 1 美元，并赢得 $$k$ 美元。请计算玩这个游戏一次的期望收入。

C. 3-4 证明：若 $$X$$ 与 $$Y$$ 是非负随机变量，则
$$
E[\max(X, Y)] \leqslant E[X] + E[Y]
$$

*C. 3-5 令 $$X$$ 与 $$Y$$ 是独立随机变量。证明对于任何函数 $$f$$ 与 $$g$$，$$f(X)$$ 和 $$g(Y)$$ 是独立的。

*C. 3-6 令 $$X$$ 是非负随机变量，并假定 $$E[X]$$ 是有定义的。证明马尔可夫不等式：对于所有 $$t > 0$$，
$$
\Pr\{X \geqslant t\} \leqslant E[X] / t \quad \text{(C. 30)}
$$

*C. 3-7 令 $$S$$ 为样本空间，$$X$$ 和 $$X'$$ 是随机变量，满足对于所有 $$s \in S$$，有 $$X(s) \geqslant X'(s)$$。证明：对于任意实常数 $$t$$，
$$
\Pr\{X \geqslant t\} \geqslant \Pr\{X' \geqslant t\}
$$

C. 3-8 一个随机变量的平方的期望与其期望的平方哪个大？

C. 3-9 证明：对于任意取值仅为 0 或 1 的随机变量 $$X$$，有 $$\operatorname{Var}[X] = E[X] E[1 - X]$$。

C. 3-10 根据方差定义 (公式 (C. 27)) 证明：$$\operatorname{Var}[aX] = a^2 \operatorname{Var}[X]$$。

### 练习C.4

C. 4-1 对几何分布验证概率公理 2。

C. 4-2 掷 6 个骰子平均要掷多少次才能得到 3 个正面和 3 个反面的结果？

C. 4-3 证明：$$b(k; n, p) = b(n-k; n, q)$$，其中 $$q = 1 - p$$。

C. 4-4 证明：二项分布 $$b(k; n, p)$$ 的最大值近似等于 $$1/\sqrt{2\pi n p q}$$，其中 $$q = 1 - p$$。

*C. 4-5 证明：$$n$$ 次伯努利试验（成功概率为 $$p = 1/ n$$）一次也未成功的概率近似等于 $$1/e$$。证明：只有一次成功的概率也近似为 $$1/e$$。

*C. 4-6 Rosencrantz 教授与 Guildenstern 教授各扔一枚均匀硬币 $n$ 次。证明：他们得到正面朝上次数相同的概率为 $$\binom{2 n}{n}/ 4^n$$。（提示：对于 Rosencrantz 教授，称正面为成功；对于 Guildenstern 教授，称背面为成功。）并用你的结论来验证恒等式
$$
\sum_{k=0}^n \binom{n}{k}^2 = \binom{2 n}{n}
$$

*C. 4-7 证明：对于 $$0 \leqslant k \leqslant n$$，
$$
b(k; n, 1/2) \leqslant 2^{n H(k/n) - n}
$$
其中 $H(x)$ 是熵函数 (公式 C. 7)。

*C. 4-8 考虑 $$n$$ 次伯努利试验，其中 $$i = 1, 2, \cdots, n$$，第 $i$ 次试验成功的概率为 $$p_i$$，令 $$X$$ 为表示总成功次数的随机变量。令对所有 $$i = 1, 2, \cdots, n$$ 有 $$p \geqslant p_i$$。证明：对于 $$1 \leqslant k \leqslant n$$，
$$
\Pr\{X < k\} \geqslant \sum_{i=0}^{k-1} b(i; n, p)
$$

*C. 4-9 令 $$X$$ 为表示 $$n$$ 次伯努利试验构成的集合 $$A$$ 中总成功次数的随机变量，其中第 $i$ 次试验成功的概率为 $$p_i$$，并令 $$X'$$ 为表示另一个由 $$n$$ 个伯努利试验构成的集合 $$A'$$ 中总成功次数的随机变量，其中第 $i$ 次试验的成功概率 $$p'_i \geqslant p_i$$。证明：对于 $$0 \leqslant k \leqslant n$$，
$$
\Pr\{X' \geqslant k\} \geqslant \Pr\{X \geqslant k\}
$$
(提示：说明如何通过包含 $$A$$ 中试验的实验来获得 $$A'$$ 中的伯努利试验，并使用练习 C. 3-7 中的结论。)

### 练习C.5

*C. 5-1 抛掷一枚均匀硬币 $$n$$ 次都为反面朝上的概率与抛掷一枚均匀硬币 $$4n$$ 次得到少于 $$n$$ 个正面的概率哪个小？

*C. 5-2 证明推论 C.6 和推论 C.7。

*C. 5-3 证明：对于所有满足 $$0 < k < na/(a + 1)$$ 的 $$a > 0$$ 和 $$k$$，有
$$
\sum_{i=0}^k \binom{n}{i} a^i < (a + 1)^n \frac{k}{na - k(a + 1)} b(k; n, a/(a + 1))
$$

*C. 5-4 证明：若 $$0 < k < np$$，其中 $$0 < p < 1$$ 且 $$q = 1 - p$$，则
$$
\sum_{i=0}^{\infty} p^i q^{n-i} < \frac{kq}{np - k} \left(\frac{np}{k}\right)^k \left(\frac{nq}{n - k}\right)^{n-k}
$$

*C. 5-5 利用定理 C.8 的证明：对于 $$r > n - \mu$$，
$$
\Pr(\mu - X \geqslant r) \leqslant \left(\frac{n - \mu}{r}\right)^r
$$
类似地，利用推论 C. 9 证明：对于 $$r > n - np$$，
$$
\Pr(np - X \geqslant r) \leqslant \left(\frac{nqe}{r}\right)
$$

*C. 5-6 考虑 $$n$$ 次伯努利试验的序列，其中第 $$i$$ 次成功的概率为 $$p_i$$，失败的概率为 $$q_i = 1 - p_i$$，$$i = 1, 2, \cdots, n$$。令 $$X$$ 为表示成功总数的随机变量，令 $$\mu = E[X]$$。证明：对于 $$r \geqslant 0$$，有
$$
\Pr(X - \mu \geqslant r) \leqslant e^{-r^2/2n}
$$
（提示：证明 $$p_i e^{r_i} + q_i e^{-r_i} \leqslant e^{r/2}$$。然后根据定理 C.8 的证明思路，并利用该不等式替代不等式 (C. 45)。）

*C. 5-7 证明：选择 $$\alpha = \ln(r/\mu)$$ 可以使不等式 (C. 47) 右侧取最小值。

### 思考题

C-1（球与盒子）在本题中，我们研究了在几种假设条件下，将 $$n$$ 个球放到 $$b$$ 个箱子的方法数。

a. 假定 $$n$$ 个球是不同的且不考虑它们在盒子中的顺序。证明：有 $$b^n$$ 种方法将球放入盒子中。

b. 假定 $$n$$ 个球是不同的且它们在盒子中有序。证明：恰有 $$(b + n - 1)! / (b - 1)!$$ 种方法将球放入盒子中。（提示：考虑将 $$n$$ 个不同的球和 $$b - 1$$ 根相同的棍子排列成一排的方法数。）

c. 假定 $$n$$ 个球是相同的，从而无需考虑其在盒子中的顺序。证明：将球放入盒子的方法数是 $$\binom{n + b - 1}{b - 1}$$。（提示：若球相同，则 (b) 中的排列有多少是重复的？）

d. 假定球是相同的，且每个盒子最多只能放一个球，从而有 $$n \leqslant b$$。证明：将球放入盒子中的方法数是 $$\binom{n}{b}$$。

e. 假定球是相同的，并且盒子不能为空。假定 $$n \geqslant b$$，证明：将球放入盒子的方法数是 $$\binom{n - 1}{b - 1}$$。

## 附录D 矩阵

### 练习D.1

D. 1-1 证明：若 $$A$$ 与 $$B$$ 均为 $$n \times n$$ 对称矩阵，则 $$A+B$$ 和 $$A-B$$ 也是 $$n \times n$$ 对称矩阵。

D. 1-2 证明：$$(AB)^T = B^T A^T$$，以及 $$A^T A$$ 是对称矩阵。

D. 1-3 证明：两个下三角矩阵的积是下三角矩阵。

D. 1-4 证明：若 $$P$$ 是 $$n \times n$$ 排列矩阵，$$A$$ 是 $$n \times n$$ 矩阵，则矩阵积 $$PA$ 是 $$A$$ 行变换后的矩阵，而矩阵积 $$AP$ 是矩阵 $$A$$ 列变换后的矩阵。证明：两个排列矩阵的积是排列矩阵。

### 练习D.2

D. 2-1 证明：矩阵的逆是唯一的，即如果 $$B$$ 和 $$C$$ 均为 $$A$$ 的逆，那么 $$B = C$$。

D. 2-2 证明：下三角矩阵或上三角矩阵的行列式与其对角线元素之积相等。证明：一个下三角矩阵的逆是下三角矩阵。

D. 2-3 证明：如果 $$P$$ 是一个排列矩阵，则 $$P$$ 是可逆的，它的逆是 $$P^T$$，且 $$P^T$$ 也是一个排列矩阵。

D. 2-4 令 $$A$$ 和 $$B$$ 是 $$n \times n$$ 矩阵，且 $$AB = I$$。证明：若矩阵 $$A'$$ 是将矩阵 $$A$$ 第 $i$ 行加到第 $j$ 行所得，则将 $$B$$ 中第 $j$ 列减去第 $i$ 列所得的 $$B'$$ 为 $$A'$$ 的逆矩阵。

D. 2-5 令 $$A$$ 是一个非奇异 $$n \times n$$ 复数矩阵。证明：$$A^{-1}$$ 中每个元素均为实数，当且仅当 $A$ 中每个元素是实数。

D. 2-6 证明：若 $$A$$ 是一个非奇异的 $$n \times n$$ 对称矩阵，则 $$A^{-1}$$ 是对称的。证明：若 $$B$$ 是任意 $$m \times n$$ 矩阵，则 $$m \times m$$ 矩阵 $$AB^T$$ 也是对称的。

D. 2-7 证明定理 D.2。也就是说，证明：一个矩阵 $$A$$ 是列满秩的，当且仅当 $Ax=0$ 蕴涵涵 $x=0$。

D. 2-8 证明：对于任意两个相容矩阵 $A$ 和 $B$，
$$
\text{rank}(AB) \leqslant \min(\text{rank}(A), \text{rank}(B))
$$
其中，如果 $A$ 或 $$B$$ 是非奇异方阵，则等式成立。（提示：使用矩阵秩的另一种定义。）

#### 思考题

D-1 （范德蒙德矩阵）给定数值
$$
V(x_0, x_1, \cdots, x_{n-1}) =
\begin{bmatrix}
1 & x_0 & x_0^2 & \cdots & x_0^{n-1} \\
1 & x_1 & x_1^2 & \cdots & x_1^{n-1} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
1 & x_{n-1} & x_{n-1}^2 & \cdots & x_{n-1}^{n-1}
\end{bmatrix}
$$
是
$$
\det(V(x_0, x_1, \cdots, x_{n-1})) = \prod_{0 \leqslant i < j \leqslant n-1} (x_i - x_j)
$$
（提示：对于 $$i = n-1, n-2, \cdots, 1$$，将第 $\$i$ 列乘以 $$-x_0$$ 后加到第 $$i+1$$ 列上，然后使用归纳法。）

D-2 （在 $GF(2)$ 上利用矩阵-向量乘法定义的排列）利用 $GF(2)$ 上矩阵乘法可以定义一类集合 $$S_n = \{0, 1, 2, \cdots, 2^{n-1}\}$$ 中整数的排列。对于 $$S_n$$ 中每个整数，可以将它的二进制表示形式看做一个 $$n$$ 位向量。

其中 $$\sum_{i=0}^n x_i 2^i$$。如果 $$A$$ 是一个元素均为 0 或 1 的 $$n \times n$$ 矩阵，则我们可以定义一个排列。该排列将 $$S_n$$ 中的每一个值 $$x$$ 映射到一个数上，该数的二进制表示形式为矩阵-向量积 $$Ax$$。这里，我们按照 $$GF(2)$$ 执行所有算术运算；所有的值为 0 或 1，并且除特例 $$1+1=0$$ 外，其他常规加法、乘法规则均适用。读者可以认为 $$GF(2)$$ 算术运算除了只使用最低有效位，其他均与常规整数算术运算一致。

例如，对于 $$S_3 = \{0, 1, 2, 3\}$$，矩阵
$$
A = \begin{bmatrix}
1 & 0 & 1 \\
1 & 1 & 1
\end{bmatrix}
$$
定义了如下排列 $\pi_A$：$\pi_A(0) = 0$，$$\pi_A(1) = 3$$，$$\pi_A(2) = 2$$，$$\pi_A(3) = 1$$。下面解释 $$\pi_A(3) = 1$$ 的理由，观察在 $$GF(2)$$ 中，
$$
\pi_A(3) = \begin{bmatrix}
1 & 0 \\
1 & 1
\end{bmatrix}
\begin{bmatrix}
1 \\
1
\end{bmatrix}
= \begin{bmatrix}
1 \\
0
\end{bmatrix}
+ \begin{bmatrix}
1 \\
1
\end{bmatrix}
= \begin{bmatrix}
0 \\
1
\end{bmatrix}
$$
就是 1 的二进制表示。

我们继续在 $$GF(2)$$ 上讨论本问题，并且所有矩阵和向量的元素均为 0 或 1。定义 0-1 矩阵（元素均为 0 或 1 的矩阵）在 $$GF(2)$$ 上的秩与普通矩阵一致，但是所有的线性相关的算术运算都按 $$GF(2)$$ 进行。定义 $$n \times n - 1$$ 矩阵 $$A$$ 的取值范围为
$$
R(A) = \{y: y = Ax, x \in S_n\}
$$
这样，$$R(A)$$ 是 $$S_n$$ 中一类数的集合，这类数可以由将 $$S_n$$ 中每个值 $$x$$ 乘以 $$A$$ 得到。

a. 如果 $$r$$ 是矩阵 $$A$$ 的秩，证明 $$|R(A)| = 2^r$$。证明：$A$ 定义一个 $$S_n$$ 上的排列，当且仅当 $$A$$ 是满秩的。

对于一个给定的 $$n \times n$$ 矩阵 $A$ 和一个给定的值 $$y \in R(A)$$，定义 $y$ 的原象为
$$
P(A, y) = \{x; Ax = y\}
$$
从而，$P(A, y)$ 即为 $S_n$ 中乘以 $A$ 后会映射到 $y$ 的值的集合。

b. 如果 $$r$$ 是 $$n \times n$$ 矩阵 $$A$$ 的秩且 $y \in R(A)$，证明 $$|P(A, y)| = 2^{n-r}$$。

令 $$0 \leqslant m \leqslant n$$，假定将集合 $$S_n$$ 划分成相邻数字的块，其中第 $i$ 个块包含 $2^m$ 个数 $$i 2^m, i 2^m + 1, i 2^m + 2, \cdots, (i+1) 2^m - 1$$。对于任意子集 $$S \subseteq S_n$$，定义 $$B(S, m)$$ 为包含 $$S$$ 中某元素的 $$S_n$$ 中大小为 $$2^m$$ 的块的集合。例如，当 $$n=3, m=1$$，且 $S = \{1, 4, 5\}$ 时，$$B(S, m)$$ 包含块 0（因为 1 在第 0 块中）和块 2（因为 4 和 5 均在块 2 中）。

c. 令 $r$ 是 $$A$$ 的左下部 $$(n-m) \times m$$ 子矩阵的秩，即通过取矩阵 $$A$$ 底部 $$n-m$$ 行和最左端 $m$ 列的交获得的矩阵。令 $S$ 是 $$S_n$$ 中任意大小为 $$2^m$$ 的块，且令 $$S' = \{y: y = Ax, x \in S\}$$。证明：$$|B(S', m)| = 2^r$$ 且对于 $B(S', m)$ 中每一个块，有且仅有 $$2^{m-r}$$ 个 $S$ 中的列映射到该块上。

因为将零向量乘以任意矩阵均得到零向量，所以通过 $$GF(2)$$ 上乘以满秩 $$n \times n$$ 0-1 矩阵所定义的 $$S_n$$ 的排列集合不能囊括 $S_n$ 所有的排列。这里，将由矩阵-向量乘法定义的那类排列扩展，以包含一个附加项，从而 $$x \in S_n$$ 映射到 $$Ax + c$$ 上，其中 $c$ 是 $n$ 位向量，加法按 $$GF(2)$$ 执行。例如，当

$$
A = \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix}
$$

且

$$
c = \begin{bmatrix} 0 \\ 1 \end{bmatrix}
$$

我们可以获得如下排列$\pi_{A,c}:\pi_{A,c}(0)=2,\pi_{A,c}(1)=1,\pi_{A,c}(2)=0,\pi_{A,c}(3)=3$。对于某个$n\times n$ 0-1满秩矩阵$A$和某个$n$位向量$c$,称任意将$x\in\mathcal{S}_n$映射到$Ax+c$的排列为一个线性排列。

d. 用计数观点来证明：$S_n$ 的线性排列的数目远小于$S_n$ 排列的数目。

e.请给出一个$S_n$的排列的例子及$n$的值，其中该排列不能通过任何线性排列获得。(提示：对于一个给定的排列，考虑矩阵与单位向量相乘和矩阵的列的关系。)







